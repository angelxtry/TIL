# csv excel

ê° ì¤„ì€ ê°œí–‰ë¬¸ì, ê° ì»¬ëŸ¼ì€ ì½¤ë§ˆë¡œ êµ¬ë¶„

TSV(Tab Seperated Values) í¬ë©§ë„ csvë¼ê³  ë¶€ë¥´ê¸°ë„ í•œë‹¤.

Plain text íŒŒì¼ì´ë¯€ë¡œ ë‹¤ì–‘í•œ ì¸ì½”ë”©ìœ¼ë¡œ ì‘ì„±ê°€ëŠ¥

í•œê¸€ ì—‘ì…€ì—ì„œ csv íŒŒì¼ì„ ìƒì„±í•˜ë©´ cp949 ì¸ì½”ë”©ìœ¼ë¡œ ìƒì„±ë¨

í•œê¸€ ì—‘ì…€ì—ì„œ UTF-8 csvíŒŒì¼ë„ ì½ì–´ë“¤ì¼ ìˆ˜ ìˆìŒ

íŒŒì´ì¬ csv ëª¨ë“ˆì—ì„œë„ UTF-8ì´ ë””í´íŠ¸

Pandas, excel, githubì—ì„œë„ csvë¥¼ ì§€ì›

```py
lines = """ì›”ìš”ì›¹íˆ°,í™”ìš”ì›¹íˆ°,ìˆ˜ìš”ì›¹íˆ°,ëª©ìš”ì›¹íˆ°,ê¸ˆìš”ì›¹íˆ°,í† ìš”ì›¹íˆ°,ì¼ìš”ì›¹íˆ°
        ì‹ ì˜ íƒ‘,ë§ˆìŒì˜ì†Œë¦¬,ê³ ìˆ˜,ê¸°ê¸°ê´´ê´´,ë´ë§ˆ,í˜¸ë‘ì´í˜•ë‹˜,ì—´ëŸ½ì „ì‚¬
        ê·€ì „êµ¬ë‹´,ë…¸ë¸”ë ˆìŠ¤,í¼ë¯¸ìŠ¤ë¯¸ì…˜,í•˜ë£¨ 3ì»·,í…ŒëŸ¬ë§¨,ë¶€í™œë‚¨,ë‹¤ì´ìŠ¤
        íˆì–´ë¡œë©”ì´ì»¤,í•˜ì´ë¸Œ,DEY í˜¸ëŸ¬ì±„ë„,ë§ˆìˆ ì‚¬,ì˜¤ì¦ˆëœë“œ,ìœ ë¯¸ì˜ì„¸í¬ë“¤,ì¡°ì„ ì™•ì¡°ì‹¤í†¡"""
with open('webtoon.csv', 'wt', encoding='utf8') as f:
    f.write(lines)
```

ë¬¸ìì—´ ì¡°í•©ì„ ì§ì ‘í•˜ë©´ ê°€ë…ì„±ë„ ë–¨ì–´ì§€ê³  ë°ì´í„°ê°€ ë§ì•„ì§€ë©´ ë³µì¡í•˜ê³  ë²ˆê±°ë¡­ë‹¤.

`wt`ëŠ” write/textë¥¼ ì˜ë¯¸(`wb`ëŠ” binary modeë¥¼ ì˜ë¯¸í•œë‹¤.)

```py
rows = [
    ['ì›”ìš”ì›¹íˆ°', 'í™”ìš”ì›¹íˆ°', 'ìˆ˜ìš”ì›¹íˆ°', 'ëª©ìš”ì›¹íˆ°', 'ê¸ˆìš”ì›¹íˆ°', 'í† ìš”ì›¹íˆ°', 'ì¼ìš”ì›¹íˆ°'],
    ['ì‹ ì˜ íƒ‘', 'ë§ˆìŒì˜ì†Œë¦¬', 'ê³ ìˆ˜', 'ê¸°ê¸°ê´´ê´´', 'ë´ë§ˆ', 'í˜¸ë‘ì´í˜•ë‹˜', 'ì—´ëŸ½ì „ì‚¬'],
    ['ê·€ì „êµ¬ë‹´', 'ë…¸ë¸”ë ˆìŠ¤', 'í¼ë¯¸ìŠ¤ë¯¸ì…˜', 'í•˜ë£¨ 3ì»·', 'í…ŒëŸ¬ë§¨', 'ë¶€í™œë‚¨', 'ë‹¤ì´ìŠ¤'],
    ['íˆì–´ë¡œë©”ì´ì»¤', 'í•˜ì´ë¸Œ', 'DEY í˜¸ëŸ¬ì±„ë„', 'ë§ˆìˆ ì‚¬', 'ì˜¤ì¦ˆëœë“œ', 'ìœ ë¯¸ì˜ì„¸í¬ë“¤', 'ì¡°ì„ ì™•ì¡°ì‹¤í†¡'],
]

lines = '\r\n'.join(','.join(row) for row in rows)

with open('webtoon.csv', 'wt', encoding='utf8') as f:
    f.write(lines)
```

rows ë¥¼ ë¦¬ìŠ¤íŠ¸ ì»´í”„ë¦¬í•¸ì…˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë§Œë“¤ì—ˆë‹¤.

ì´ê²ƒë„ ë²ˆê±°ë¡­ë‹¤.

```py
import csv

rows = [
    ['ì›”ìš”ì›¹íˆ°', 'í™”ìš”ì›¹íˆ°', 'ìˆ˜ìš”ì›¹íˆ°', 'ëª©ìš”ì›¹íˆ°', 'ê¸ˆìš”ì›¹íˆ°', 'í† ìš”ì›¹íˆ°', 'ì¼ìš”ì›¹íˆ°'],
    ['ì‹ ì˜ íƒ‘', 'ë§ˆìŒì˜ì†Œë¦¬', 'ê³ ìˆ˜', 'ê¸°ê¸°ê´´ê´´', 'ë´ë§ˆ', 'í˜¸ë‘ì´í˜•ë‹˜', 'ì—´ëŸ½ì „ì‚¬'],
    ['ê·€ì „êµ¬ë‹´', 'ë…¸ë¸”ë ˆìŠ¤', 'í¼ë¯¸ìŠ¤ë¯¸ì…˜', 'í•˜ë£¨ 3ì»·', 'í…ŒëŸ¬ë§¨', 'ë¶€í™œë‚¨', 'ë‹¤ì´ìŠ¤'],
    ['íˆì–´ë¡œë©”ì´ì»¤', 'í•˜ì´ë¸Œ', 'DEY í˜¸ëŸ¬ì±„ë„', 'ë§ˆìˆ ì‚¬', 'ì˜¤ì¦ˆëœë“œ', 'ìœ ë¯¸ì˜ì„¸í¬ë“¤', 'ì¡°ì„ ì™•ì¡°ì‹¤í†¡'],
]

with open('webtoon.csv', 'wt', encoding='utf8') as f:
    writer = csv.writer(f)
    writer.writerows(rows)
```

csv.writerë¡œ íŒŒì¼ ê°ì²´ë¥¼ wrappingí•˜ê³  writerows()ë¡œ ì—¬ëŸ¬ ì¤„ì„ í•œë²ˆì— íŒŒì¼ì— ê¸°ë¡í–ˆë‹¤.

writerow() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ í•œ ì¤„ ì”© ê¸°ë¡í•œë‹¤.

êµ¬ë¶„ìë„ ì½¤ë§ˆì—ì„œ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

```py
writer = csv.writer(f, delimeter='|')
```

êµ¬ë¶„ìëŠ” ì–´ë–¤ ë¬¸ìë“  ê°€ëŠ¥í•˜ë‹¤.

ë°ì´í„°ê°€ rowë‚˜ tupleì¼ ë•ŒëŠ” csv.writer()

ë°ì´í„°ê°€ dictì¼ ë•ŒëŠ” csv.DictWriter(íŒŒì¼ê°ì²´, fieldnames=fieldnames)ë¥¼ ì‚¬ìš©í•œë‹¤.

```py
import csv

fieldnames = ['first_name', 'last_name']
writer = csv.DictWriter(file_obj, fieldnames=fieldnames)

writer.writeheader()

# 1 row
writer.writerow({'first_name': 'aaa', 'last_name': 'bbb'})

# ë‹¤ìˆ˜ rows
wirter.writerows([
    {'first_name': 'aaa', 'last_name': 'bbb'},
    {'first_name': 'ccc', 'last_name': 'ddd'},
])
```

ì‚¬ì „ì€ ìˆœì„œê°€ ì—†ê¸°ë•Œë¬¸ì— ìˆœì„œë¥¼ ì§€ì •í•´ì£¼ê¸° ìœ„í•´ fieldnamesë¥¼ ì‚¬ìš©í•œë‹¤.

----

csv íŒŒì¼ ì½ê¸°

```py
with open('webtoon.csv', 'rt', encoding='utf8') as f:
    for line in f:
        row = line.split(',') # ë¦¬ìŠ¤íŠ¸ê°€ ë§Œë“¤ì–´ì§„ë‹¤.
        print(row)
```

ì´ë ‡ê²Œ í•˜ëŠ” ê²ƒì€ ë²ˆê±°ë¡­ë‹¤.

ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì— ê°œí–‰ë¬¸ìë„ ë¶™ì–´ìˆìœ¼ë¯€ë¡œ ë°ì´í„°ë¡œ ì“°ë ¤ë©´ ì œê±°ê°€ í•„ìš”í•˜ë‹¤.

```py
import csv

with open('webtoon.csv', 'rt', encoding='utf8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row) # list type
```

ì‚¬ì „ í˜•ì‹ìœ¼ë¡œ ì½ìœ¼ë ¤ë©´

```py
import csv

with open('webtoon_dict.csv', 'rt', encoding='utf8') as f:
    fieldnames = None # ë””í´ë“œ, Noneì´ë©´ ì²« ë²ˆì§¸ Rowê°€ fieldnamesë¡œ ì§€ì •ëœë‹¤.
    reader = csv.DictReader(f, fieldnames=fieldnames)
    for row in reader:
        print(row) # dict type
```

header rowë¥¼ ì œì™¸í•œ ë°ì´í„°ê°€ ì‚¬ì „ í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ë‹¤.

```py
import csv

with open('webtoon_dict.csv', 'rt', encoding='utf8') as f:
    line = next(f) # ì²« 1 ë¼ì¸ì„ ì½ëŠ”ë‹¤.
    fieldnames = line.split(',')
    reader = csv.DictReader(f, fieldnames=fieldnames)
    for row in reader:
        print(row)
```

ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ headerë¥¼ ì§€ì •í•  ìˆ˜ ìˆì§€ë§Œ ì²« ë²ˆì§¸ ë°©ì‹ì´ ì¢€ ë” ê°„í¸í•˜ë‹¤.

fieldnamesëŠ” Noneì´ ë””í´íŠ¸ì´ë¯€ë¡œ ìƒëµí•´ë„ ëœë‹¤.

----

ìƒì„±í•œ csv íŒŒì¼ì„ ìœˆë„ìš° ì—‘ì…€ì—ì„œ ì—´ì—ˆì„ ë•Œ ì¸ì½”ë”© ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

í•œê¸€ ìœˆë„ìš°ì˜ ê¸°ë³¸ ì¸ì½”ë”©ì€ cp949

csv íŒŒì¼ì€ Plain textì´ë¯€ë¡œ ì¸ì½”ë”©ì„ ëª…ì‹œí•  ìˆ˜ ì—†ë‹¤.

í•˜ì§€ë§Œ ìœˆë„ìš°ì—ì„œëŠ” BON(Byte Order Mark)ë¥¼ í†µí•´ ì¸ì½”ë”©ì„ ëª…ì‹œí•  ìˆ˜ ìˆë‹¤.

êµ¬ë¶„ | CP949 | UTF8 | UTF8_BOM 
--- | --- | --- | --- 
ì—‘ì…€ | ok | ì˜µì…˜ì§€ì • | ok
êµ¬ê¸€ìŠ¤í”„ë ˆë“œ | ok | ok | ok
Pandas | ì˜µì…˜ì§€ì • | ok | ok
Python | ì˜µì…˜ì§€ì • | ok | BOMì œê±°í•„ìš”

íŒŒì´ì¬ì—ì„œ CP949 ì¸ì½”ë”© ì½ê¸°

```py
with open('cp949.csv', encoding='cp949') as f:
    reader = csv.reader(f)
```

íŒŒì´ì¬ì—ì„œ UTF8 BOM ì½ê¸°

```py
import csv
import codecs

with open('utf_with_bom.csv', 'rb') as f:
    content = f.read()
    if content.startswith(codecs.BOM_UTF8):
        bom_size = len(codecs.BOM_UTF8)
        content = content[bom_size:]
    string = content.decode('utf8')

    reader = csv.reader(string.splitlines())
    for line in reader:
        print(line)
```
 BOMì€ 3byte ë¬¸ìì—´ì´ë‹¤.

 binary ëª¨ë“œë¡œ íŒŒì¼ì„ ì—´ì–´ì„œ ì²« 3byteê°€ BOMì¸ì§€ í™•ì¸í•œ í›„ ë§ë‹¤ë©´ 3byteë¥¼ ì˜ë¼ë‚¸ë‹¤.

 ë‚˜ë¨¸ì§€ ë¬¸ìì—´ì„ utf8ë¡œ decode í•œ í›„ splitlinesë¡œ í•œ ë¼ì¸ì”© ì½ì–´ì„œ ì²˜ë¦¬í•œë‹¤.
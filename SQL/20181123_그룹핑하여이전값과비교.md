# 그룹핑 하여 이전 값과 비교

```sql
WITH TBL AS (
    SELECT '20181101' DATE_FROM, '20181103' DATE_TO, 'ABC' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181104' DATE_FROM, '20181105' DATE_TO, 'ABC' AS NAME, 2 AS SCORE FROM DUAL UNION ALL
    SELECT '20181106' DATE_FROM, '20181110' DATE_TO, 'ABC' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181111' DATE_FROM, '20181121' DATE_TO, 'ABC' AS NAME, 8 AS SCORE FROM DUAL UNION ALL
    SELECT '20181122' DATE_FROM, '20181123' DATE_TO, 'ABC' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181101' DATE_FROM, '20181102' DATE_TO, 'CDE' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181103' DATE_FROM, '20181108' DATE_TO, 'CDE' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181109' DATE_FROM, '20181115' DATE_TO, 'CDE' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181116' DATE_FROM, '20181120' DATE_TO, 'CDE' AS NAME, 12 AS SCORE FROM DUAL UNION ALL
    SELECT '20181121' DATE_FROM, '20181122' DATE_TO, 'CDE' AS NAME, 11 AS SCORE FROM DUAL
)
SELECT DATE_FROM, DATE_TO, NAME, SCORE
FROM TBL
;

WITH TBL AS (
    SELECT '20181101' DATE_FROM, '20181103' DATE_TO, 'ABC' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181104' DATE_FROM, '20181105' DATE_TO, 'ABC' AS NAME, 2 AS SCORE FROM DUAL UNION ALL
    SELECT '20181106' DATE_FROM, '20181110' DATE_TO, 'ABC' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181111' DATE_FROM, '20181121' DATE_TO, 'ABC' AS NAME, 8 AS SCORE FROM DUAL UNION ALL
    SELECT '20181122' DATE_FROM, '20181123' DATE_TO, 'ABC' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181101' DATE_FROM, '20181102' DATE_TO, 'CDE' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181103' DATE_FROM, '20181108' DATE_TO, 'CDE' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181109' DATE_FROM, '20181115' DATE_TO, 'CDE' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181116' DATE_FROM, '20181120' DATE_TO, 'CDE' AS NAME, 12 AS SCORE FROM DUAL UNION ALL
    SELECT '20181121' DATE_FROM, '20181122' DATE_TO, 'CDE' AS NAME, 11 AS SCORE FROM DUAL
)
SELECT
DATE_FROM
, DATE_TO
, NAME
, SCORE
, LAG(SCORE) OVER(PARTITION BY NAME ORDER BY DATE_FROM) BEFORE_SCORE
, SCORE - LAG(SCORE) OVER(PARTITION BY NAME ORDER BY DATE_FROM) AS GROWTH
FROM TBL
;

WITH TBL AS (
    SELECT '20181101' DATE_FROM, '20181103' DATE_TO, 'ABC' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181104' DATE_FROM, '20181105' DATE_TO, 'ABC' AS NAME, 2 AS SCORE FROM DUAL UNION ALL
    SELECT '20181106' DATE_FROM, '20181110' DATE_TO, 'ABC' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181111' DATE_FROM, '20181121' DATE_TO, 'ABC' AS NAME, 8 AS SCORE FROM DUAL UNION ALL
    SELECT '20181122' DATE_FROM, '20181123' DATE_TO, 'ABC' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181101' DATE_FROM, '20181102' DATE_TO, 'CDE' AS NAME, 1 AS SCORE FROM DUAL UNION ALL
    SELECT '20181103' DATE_FROM, '20181108' DATE_TO, 'CDE' AS NAME, 5 AS SCORE FROM DUAL UNION ALL
    SELECT '20181109' DATE_FROM, '20181115' DATE_TO, 'CDE' AS NAME, 9 AS SCORE FROM DUAL UNION ALL
    SELECT '20181116' DATE_FROM, '20181120' DATE_TO, 'CDE' AS NAME, 12 AS SCORE FROM DUAL UNION ALL
    SELECT '20181121' DATE_FROM, '20181122' DATE_TO, 'CDE' AS NAME, 11 AS SCORE FROM DUAL
)
SELECT
DATE_FROM
, DATE_TO
, NAME
, SCORE
, LAG(SCORE) OVER(PARTITION BY NAME ORDER BY DATE_FROM) BEFORE_SCORE
, SCORE - LAG(SCORE) OVER(PARTITION BY NAME ORDER BY DATE_FROM) AS GROWTH
FROM TBL
;
```
# 4. 컬렉션으로 작업하기
> 파이썬은 전체 컬렉션을 처리하는 여러 함수를 제공한다. 이들을 시퀀스(리스트나 튜플), 집합, 매핑, 제네레이터 식의 결과인 반복 가능 객체에 적용할 수 있다.

> 이번 작에서는 다음 함수를 컬렉션과 함께 사용하는 방법은 살펴본다.
> * any() 와 all()
> * len(), sum() 및 이러한 함수와 관련 있는 고차 통계 처리 방법
> * zip() 및 이와 관련 있는 데이터의 리스트를 조직화하거나 펼치는 기법
> * reversed()
> * enumerate()

> 첫 네 함수는 모두 축약(reduction)이라 부를 수 있다. 이들은 컬렉션을 단일 값으로 줄여주기 때문이다. 다른 세 가지 함수(zip(), reversed(), enumerate())는 매핑이다. 이들은 기존의 컬렉션에서 새 컬렉션을 만든다. 다음 장에서는 처리를 특화하기 위해 함수를 인자로 받는 몇몇 mapping()과 reduction() 함수들을 살펴본다.

## 함수의 다양성에 대한 정리
> 우리는 다으모가 같이 함수를 두 가지 넓은 부류로 구별해야 한다.
> * 스칼라(scalar) 함수는 개별 값에 적용할 수 있고, 개별적인 결과를 내놓는다. abs(), pow() 등의 함수나 math 모듈에 있는 모든 함수들이 바로 스칼라 함수의 예다.
> * Collection() 함수는 반복 가능한 컬렉션에 작용한다.

> 컬렉션 함수는 다음과 같이 세 가지로 나눌 수 있다.
> * 축약(reduction): 컬렉션에 있는 여러 값을 함수를 사용해 겹쳐 호출함으로써 최종적으로는 단일 값을 만들어 낸다. 이를 종합(aggregate) 함수라 부르기도 한다. 왜냐하면 입력 컬렉션의 여러 값을 하나로 종합한 값을 반환하기 때문이다.
> * 매핑(mapping): 함수를 컬렉션의 모든 원소에 적용한다. 결과는 입력 컬렉션과 크기가 같은, 다른 컬렉션이다.
> * 걸러내기(filter): 컬렉션의 모든 원소에 함수를 적용하여 일부 원소는 버리고 일부 원소는 통과시키는 것이다. 결과는 입력 컬렉션의 부분 집합이다. 걸러내는 함수를 호출해도 아무 일도 일어나지 않을 수도 있다. 이 경우 걸러낸 출력과 입력이 같다.

## 반복 가능 객체로 작업하기
> 앞 장에서 언급한 것처럼, 우리는 종종 파이썬의 for 루프를 사용해 컬렉션에 대한 작업을 수행한다. 튜플, 리스트, 맵, 집합 등의 실체화한 컬렉션에 대해 작업하는 경우, for 루프는 상태를 명시적으로 관리한다. 이는 순수한 함수형 프로그래밍으로부터 벗어난 것이기는 하지만, 파이썬에 필요한 최적화를 반영하는 것이기도 하다.

> 우리가 for 문을 평가하는 과정에서 생기는 반복자 객체에만 상태가 한정되도록 보장할 수 있다면, 순수한 함수형 프로그래밍에서 크게 벗어나지 않은 상태에서 for문을 활용할 수 있을 것이다.

> for 루프를 사용하는 일반적인 응용으로는 `풀기(처리(감싸기(반복가능객체)))` 디자인 패턴을 들 수 있다. `감싸기()` 함수는 반복 가능 객체의 각 원소를 정렬하기 위한 키나 다른 값과 함께 2-튜플로 묶는다. 그 후 이 2-튜플을 바탕으로 처리를 수행한다. 마지막으로 `풀기()` 함수는 감싸기 위해 사용했던 (키 등의) 값을 버리고, 원래의 원소로 복원한다. 이러한 경우에 자주 사용하는 두 함수가 존재한다.

```py
fst = lambda x: x[0]
snd = lambda x: x[1]
```

> 다른 일반적인 패턴은 `감싸기(감싸기(감싸기()))`다. 이 경우, 우리는 간단한 튜플에서 시작하여 다른 결과를 추가한 후 좀 더 크고 복잡한 튜플을 만든다. 이러한 패턴을 변경한 것 중 흔히 사용하는 것으로는 `확장(확장(확장()))`이 있다. 여기서는 원래의 튜플을 감싸는 대신 한 번 확장할 때마다 새로운 namedtuple 인스턴스를 만들어낸다. 이 두 가지 모두 첨가 디자인 패턴(Accretion design pattern)이라 부를 수 있다.

## XML 파일 구문 분석하기
> XML 파일을 구문 분석하여 위경도 쌍을 가져오는 것부터 시작할 것이다. 이를 통해 파이썬에서 확실히 함수형이 아닌 기능을 감싸 값의 반복 가능한 시퀀스를 만드는 과정을 보여줄 것이다.

> xml.etree 모듈. 구문 분석한 결과인 ElementTree 객체에는 모든 값에 대해 방문할 수 있는 findall() 메서드가 들어있다.
# jQuery

* 최근에는 jQuery를 안 쓰는 경우가 많음
    * jQuery가 무거워짐
    * 브라우저가 발전하고, Web API 또한 발전함
    * 구글검색: jQuery를 쓰면 안 되는 이유
    * 대부분의 jQuery 메소드의 대안을 최근 브라우저에서는 네이티브 구현으로 제공
        * You don't need jQuery 참고

* 코드 비교

```js
// jQuery
jQuery('div:first').addClass('foo');

// 최신 javascript API
document.querySelector('div').classList.add('foo');
```

## 이벤트 리스너 등록

### onload 이벤트 리스너
* 이벤트 리스너 등록은 웹페이지 로딩 후에 하는 것이 안전하다.

```html
...
<body>
  <h1>jQuery Test</h1>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  
  <script>
    // $(document).ready(function(){
    //   console.log("웹페이지 로딩 완료");
    // });

    // $(function(){
    //   console.log("웹페이지 로딩 완료");
    // });

    window.onload = function() {
      console.log("웹페이지 로딩 완료");
    };

  </script>

</body>
</html>
```

### click 이벤트 리스너
```html
<body>
  <h1>jQuery Test</h1>

  <a id="btn-naver-1" href="http://m.naver.com" target="_blank">Naver Button 1</a>
  <a id="btn-naver-2" href="http://m.naver.com" target="_blank">Naver Button 1</a>

  <ul id="my-list">
    <li>list1</li>
    <li>list2</li>
    <li>list3</li>
  </ul>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  
  <script>
    // 리스너에 리턴값이 없으므로 호출되고 href 링크가 동작한다.
    $('#btn-naver-1').click(function() {
      console.log('clicked btn-naver-1');
    });

    // 리스너가 호출되지만 href 링크는 동작하지 않는다.
    // e.preventDefault(); 디폴트 동작 수행 방지
    // return false; 도 동일한 효과
    // return true; href 링크가 동작한다.
    $('#btn-naver-2').click(function(e) {
      e.preventDefault();
    });

    $('#my-list li').click(function() {
      var content = $(this).html();
      console.log('clicked : ' + content);
    });
  </script>

</body>
</html>
```

### submit 이벤트 리스너

* form 엘리먼트에 대한 submit 이벤트 리스너를 등록
```html
<body>
  <h1>jQuery Test</h1>

  <a id="btn-naver-1" href="http://m.naver.com" target="_blank">Naver Button 1</a>
  <a id="btn-naver-2" href="http://m.naver.com" target="_blank">Naver Button 1</a>

  <ul id="my-list">
    <li>list1</li>
    <li>list2</li>
    <li>list3</li>
  </ul>

  <form id="query-form">
    <input type="text" name="query">
    <input type="submit" name="조회">
  </form>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  
  <script>
    // form 기능을 막고, console log 만출력
    // return false; 도 동일하다.
    $('#query-form').submit(function(e) {
      e.preventDefault();
      console.log("form submit");
    });
  </script>

</body>
</html>
```

## DOM 엘리먼트 추가/삭제

```html
  <button id="lotto-btn">로또 번호를 점지해주세요.</button>
  <button id="remove-at-first">처음을 삭제</button>
  <button id="remove-at-last">마지막을 삭제</button>
  <div id="lotto-list"></div>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  
  <script>
    $('#lotto-btn').click(function() {
      var rendered = '<div class="post">로또 번호 : ' + (new Date()) + '</div>';
      // append와 appendTo는 사용방법도 다르고 return value도 다르다.
      // appendTo는 jQuery 객체를 return 한다.
      //var container = $('#lotto-list').append(rendered);
      var $added = $(rendered).appendTo('#lotto-list');
      $added.click(function() {
        $(this).remove();
      })
    })

    $('#remove-at-first').click(function() {
      $('#lotto-list div:first').remove();
    });

    $('#remove-at-last').click(function() {
      $('#lotto-list div:last').remove();
    });
  </script>

</body>
</html>
```

## 별도 템플릿을 통한 DOM 추가 삭제
* underscore.js 의 템플릿 시스템 사용

```html
  <button id="lotto-btn">로또 번호를 점지해주세요.</button>
  <button id="remove-at-first">처음을 삭제</button>
  <button id="remove-at-last">마지막을 삭제</button>
  <div id="lotto-list"></div>

  <!-- javascript로 처리되지 않도록 임의의 type을 지정 -->
  <script id="post-template" type="text/x-template">
    <div class="post">
      당첨본호는 <%= numbers %>이며, 보너스 번호는 <%= bonus %> 입니다.
    </div>
  </script>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore.js"></script>
  <script>
    $('#remove-at-first').click(function() {
      $('#lotto-list div:first').remove();
    });

    $('#remove-at-last').click(function() {
      $('#lotto-list div:last').remove();
    });

    $(function() {
      var raw_template = $('#post-template').html();
      var tpl = _.template(raw_template);

      $('#lotto-btn').click(function() {
        var sample = _.sample(_.range(1, 46), 6);
        var rendered = tpl({
          numbers: sample.slice(0, 5).sort(function(x, y) {return x - y; }),
          bonus: sample[5]
        });
        console.log(rendered);
        $(rendered).appendTo('#lotto-list');
      });
    });
  </script>

</body>
</html>
```

Ajax 진행 35분
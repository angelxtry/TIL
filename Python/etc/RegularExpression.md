# python의 정규 표현식

https://wikidocs.net/4308

## 정규 표현식의 기초, 메타 문자

* 정규 표현식에서 사용하는 메타 문자(meta characters)에는 다음과 같은 것들이 있다.

* (※ 메타 문자란 원래 그 문자가 가진 뜻이 아닌 특별한 용도로 사용되는 문자를 말한다.)

* `. ^ $ * + ? { } [ ] \ | ( )`

* 정규 표현식에 위 메타 문자들이 사용되면 특별한 의미를 갖게 된다.

## 문자 클래스 [ ]

* 우리가 가장 먼저 살펴 볼 메타 문자는 바로 문자 클래스(character class)인 [ ]이다.

* 문자 클래스로 만들어진 정규식은 "[와 ] 사이의 문자들과 매치"라는 의미를 갖는다.

* (※ 문자 클래스를 만드는 메타 문자인 [와 ] 사이에는 어떤 문자도 들어갈 수 있다.)

* 즉, 정규 표현식이 [abc]라면 이 표현식의 의미는 "a, b, c 중 한 개의 문자와 매치"를 뜻한다. 

* 이해를 돕기 위해 문자열 "a", "before", "dude"가 정규식 [abc]와 어떻게 매치되는지 살펴보자.
    * "a"는 정규식과 일치하는 문자인 "a"가 있으므로 매치
    * "before"는 정규식과 일치하는 문자인 "b"가 있으므로 매치
    * "dude"는 정규식과 일치하는 문자인 a, b, c 중 어느 하나도 포함하고 있지 않으므로 매치되지 않음

* [ ] 안의 두 문자 사이에 하이픈(-)을 사용하게 되면 두 문자 사이의 범위(From - To)를 의미한다.
    * 예를 들어 [a-c]라는 정규 표현식은 [abc]와 동일하고 [0-5]는 [012345]와 동일하다.

* 다음은 하이픈(-)을 이용한 문자 클래스의 사용 예이다.
    * [a-zA-Z] : 알파벳 모두
    * [0-9] : 숫자

* 문자 클래스([ ]) 내에는 어떤 문자나 메타 문자도 사용할수 있지만 주의해야 할 메타 문자가 1가지 있다.

* 그것은 바로 ^인데, 문자 클래스 내에 ^ 메타 문자가 사용될 경우에는 반대(not)라는 의미를 갖는다. 
    * 예를 들어 [^0-9]라는 정규 표현식은 숫자가 아닌 문자만 매치된다.

## 자주 사용하는 문자 클래스

* [0-9] 또는 [a-zA-Z] 등은 무척 자주 사용하는 정규 표현식이다.

* 이렇게 자주 사용하는 정규식들은 별도의 표기법으로 표현할 수 있다. 다음을 기억해 두자.
    * \d - 숫자와 매치, [0-9]와 동일한 표현식이다.
    * \D - 숫자가 아닌 것과 매치, [^0-9]와 동일한 표현식이다.
    * \s - whitespace 문자와 매치, [ \t\n\r\f\v]와 동일한 표현식이다.
        * 맨 앞의 빈 칸은 공백문자(space)를 의미한다.
    * \S - whitespace 문자가 아닌 것과 매치, [^ \t\n\r\f\v]와 동일한 표현식이다.
    * \w - 문자+숫자(alphanumeric)와 매치, [a-zA-Z0-9]와 동일한 표현식이다.
    * \W - 문자+숫자(alphanumeric)가 아닌 문자와 매치, [^a-zA-Z0-9]와 동일한 표현식이다.
    * 대문자로 사용된 것은 소문자의 반대임을 추측할 수 있을 것이다.


## 문자열 바꾸기

### sub

sub 메서드를 이용하면 정규식과 매치되는 부분을 다른 문자로 쉽게 바꿀 수 있다.

```py
>>> p = re.compile('(blue|white|red)')
>>> p.sub('colour', 'blue socks and red shoes')
'colour socks and colour shoes'
```
sub 메서드의 첫 번째 입력 인수는 "바꿀 문자열(replacement)"이 되고

두 번째 입력 인수는 "대상 문자열"이 된다. 

위 예에서 볼 수 있듯이 blue 또는 white 또는 red라는 문자열이 

colour라는 문자열로 바뀌는 것을 확인할 수 있다.

그런데 딱 한 번만 바꾸고 싶은 경우도 있다. 

이렇게 바꾸기 횟수를 제어하려면 다음과 같이 세 번째 입력 인수로 count 값을 넘기면 된다.

```py
>>> p.sub('colour', 'blue socks and red shoes', count=1)
'colour socks and red shoes'
```
처음 일치하는 blue만 colour라는 문자열로 한 번만 바꾸기가 실행됨을 알 수 있다.

### sub 메서드와 유사한 subn 메서드

subn 역시 sub와 동일한 기능을 하지만 리턴되는 결과를 튜플로 리턴한다는 차이가 있다. 

리턴된 튜플의 첫 번째 요소는 변경된 문자열이고, 두 번째 요소는 바꾸기가 발생한 횟수이다.

```py
>>> p = re.compile('(blue|white|red)')
>>> p.subn( 'colour', 'blue socks and red shoes')
('colour socks and colour shoes', 2)
```

### sub 메서드 사용 시 참조 구문 사용하기

sub 메서드를 사용할 때 참조 구문을 사용할 수 있다. 다음의 예를 보자.

```py
>>> p = re.compile(r"(?P<name>\w+)\s+(?P<phone>(\d+)[-]\d+[-]\d+)")
>>> print(p.sub("\g<phone> \g<name>", "park 010-1234-1234"))
010-1234-1234 park
```
위 예는 이름 + 전화번호의 문자열을 전화번호 + 이름으로 바꾸는 예이다. 

sub의 바꿀 문자열 부분에 \g<그룹명>을 이용하면 정규식의 그룹명을 참조할 수 있게된다.

다음과 같이 그룹명 대신 참조번호를 이용해도 마찬가지 결과가 리턴된다.

```py
>>> p = re.compile(r"(?P<name>\w+)\s+(?P<phone>(\d+)[-]\d+[-]\d+)")
>>> print(p.sub("\g<2> \g<1>", "park 010-1234-1234"))
010-1234-1234 park
```

## sub 메서드의 입력 인수로 함수 넣기

sub 메서드의 첫 번째 입력 인수로 함수를 넣을 수도 있다. 다음의 예를 보자.

```py
>>> def hexrepl(match):
...     "Return the hex string for a decimal number"
...     value = int(match.group())
...     return hex(value)
...
>>> p = re.compile(r'\d+')
>>> p.sub(hexrepl, 'Call 65490 for printing, 49152 for user code.')
'Call 0xffd2 for printing, 0xc000 for user code.'
```
hexrepl 함수는 match 객체(위에서 숫자에 매치되는)를 입력으로 받아

16진수로 변환하여 리턴하는 함수이다.

sub의 첫 번째 입력 인수로 함수를 사용할 경우 해당 함수의 첫 번째 입력 인수에는

정규식과 매치된 match 객체가 입력된다.

그리고 매치되는 문자열은 함수의 리턴값으로 바뀌게 된다.

# 3장. Underscore.js를 직접 만들며 함수형 자바스크립트의 뼈대 익히기

## 3.2 `_.map`, `_.each` 구현하기

### 3.2.1 ArrayLike와 Underscore.js의 컨셉

* `_.each`, `_.map` 등의 주요 함수는 첫 번째 인자로 약 2가지에서 4가지 정도의 타입을 받는다.
* {}, [], arguments, ArrayLike

```js
const d1 = { name: 'PJ', age: 25 };
const d2 = [1, 2, 3];
const d3 = function() {
  return arguments;
}(1, 2, 3);
const d4 = $('div');
const d5 = { length: 3 };
d5[0] = 1, d5[1] = 2, d5[3] = 3;
const d6 = "hi";
```

* jQuery 객체를 사용할 때 `$('div')[0]`, `$('div')[1]`과 같이 사용하는데 Array는 아니다.
* `$('div').constructor == Array`는 false다.
* d5도 Array가 아니다.
* d3도 Array가 아니라 즉시 실행된 익명 함수의 arguments 객체다. (ArrayLike 하다.)

* 다음은 ArrayLike의 정의다.

```js
const MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;
const isArrayLike = list => {
  const length = list === null ? void  0 : list.length;
  return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;
};
```

* `_.each`, `_.map`은 ArrayLike한 모든 객체를 순회한다.
* d1이 들어오면 Array가 아닐 것이라고 생각하고 객체가 가진 모든 keys를 뽑아 낸 뒤에 keys를 이용해 for문을 돌린다.

* Underscore.js는 데이터형을 체크하지 않고도 데이터를 잘 다룬다.

### 3.2.2 `_.map` 만들기

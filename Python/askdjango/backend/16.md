# Django Template Engine(Template Tag)

django 철학

Fat Model

* 풍성한 모델

* 가급적이면 비지니스 로직을 model에 구현하도록 권장

Stupid Template

* Template에 비지니스 로직을 최대한 지양하자.

Thin View

* View에도 비지니스 로직을 최대한 지양하고, 인스턴스를 획득하여 랜더링 정도의 역할만 

----

Template Engines 몇 가지

Django Template Engine : Django 기본 템플릿 엔진

Jinja2 : 써드파티 엔진이었으나, 최근에 최소한의 지원이 내장됨

* Django Template Engine과 유사

* 장고 프로젝트에서 쓰려면 django-jinja 추천

가급적이면 기본 장고 템플릿 엔진에 익숙해지기를 권장

----

Django Template Engine Syntax

{% extends "base.html" %}

{# 이것은 주석입니다. #}

{% for row in rows %}
    <tr>
        {% for name in row %}
            <td>{{ name }}</td>
        {% endfor %}
    </tr>
{% endfor %}

extends 같은 것은 template tag라고 부른다.

----

Variables

{{ first_name }}

dictionay의 key에 접근 가능 : {{ mydict.key }}

ex
```py
people = {'tom': 10, 'bob': 20}
people['tom']

{{ people.tom }}
```

object의 attirbute : {{ myobj.attr }}

함수 호출도 attr처럼 접근하지만, 인자있는 함수는 호출할 수 없다.

{{ myobj.func }}

```
python에는 callable이라는 내장함수가 있다.

callalbe(param) 이라고 호출했을 때 param이 호출가능한 객체라면 True, 호출이 불가능하다면 False가 리턴된다.
```

리스트 인덱스 접근도 가능 : {{ mylist.0 }}

----

Django Template Tag

* Django Templates 용 함수

{% %} 홀로 쓰이기도 하며 2개 이상이 조합되기도 한다.

built-in tag가 지원되며 장고앱 별로 커스텀 tag 추가 가능

block

comment

csrf_token

extends

for

for ... empty

if

ifchanged

include

load

lorem

now

url

verbatim

with 등

----

block tag

* 템플릿 상속에서 사용

* 자식 템플릿이 오버라이딩할 block 영역을 정의

* 자식 템플릿은 부모가 정의한 block에 한해서 재정의 가능. 그 외에는 모두 무시.

{% block block-name %}
    block 내에 내용 입력 가능
{% endblock %}

----

comment tag

* 템플릿 주석

* comment 영역을 서버 단에서 처리하지 않음

{# 한 줄 주석 #}

{% comment "Optional Note" %}
    여러 줄 주석
    이 부분은 랜더링되지 않는다.
    Optional Note는 안써도 무관하다. 책갈피 같은 용도로 활용할 수 있다.
{% endcomment %}

* Javascript 주석 /* */, HTML주석 <!-- --> 과 혼동하지 말자.

* JS, HTML 주석은 서버측에서는 모두 클라이언트로 랜더링한다. 단지 클라이언트에서 무시한다.

----

csrf token

* Cross Site Request Forgeries를 막기 위해 CSRF Middleware가 제공

* HTML Form의 POST 요청에서 CSRF 토큰을 체크

* csrf token tag를 이용하여 token을 발급받을 수 있다.

Form은 get, post요청을 처리한다.

get 요청이 있을 때 빈 form을 보여주고, 사용자가 form을 채워서 전송하면 post를 통해 받는다.

빈 form을 보여줄 때 서버는 csrf token을 발급하고 post 요청이 오면 발급한 csrf token을 검증한다.

----




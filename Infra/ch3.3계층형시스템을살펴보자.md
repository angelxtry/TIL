# 3계층형 시스템을 살펴보자.

## 프로세스와 스레드

프로그램은 서버 내부의 디스크 상에 설치된다.

시작 의뢰가 있으면 커널이 프로세스를 작성한다. 또한, 요청 분량만큼만 메모리 공간을 할당한다.

OS 상에서 프로세스가 시작돼서 사용자 요청을 받을 수 있게 된다.

프로세스 및 스레드는 프로그램 실행 파일 자체가 아니라 OS 상에서 실행되서 어느 정도 독립성을 가지고 동작하는 것이다.

프로세스 및 스레드가 활동하려면 메모리 공간이 필요하다. 이것은 커널에 의해 메모리 상에 확보된다.

프로세스는 독자 메모리 공간을 가지고 있다. 따라서 생성 시 CPU 부하가 스레드와 비교해 높아진다.

멀티 프로세스 애플리케이션에서는 프로세스 생성 부담을 낮추기 위해 미리 프로세스를 시작시켜 준다. 실제 예가 pooling이라 불리는 것이다.

스레드는 메모리 공간을 공유하고 있다. 스레드 시작시에 신규 메모리 공간은 필요 없지만, 다른 스레드에 이상이 발행하면 영향을 받는다.

덧. platform은 CPU + OS + 개발환경을 의미한다. 이것은 제약조건이다.

오라클에서는 각 프로세스별 메모리 공간(PGA)과 프로세스 전체가 공유하는 메모리 공간(SGA)이 나누어져 있다.

SGA에는 디스크 상의 데이터 캐시나 실행 완료된 SQL 캐시, 인덱스 등이 저장된다.

PGA에는 해당 프로세스 SQL이 이용하는 소트 영역이나 테이블 결합에 사용하는 메모리 영역이 저장되어 있다.

이 영역은 다른 프로세스가 접근할 수 없다.

## OS커널

커널이 존재하기 때문에 개발자는 하드웨어나 다른 애플리케이션에 끼치는 영향을 의식하지 않고 애플리케이션을 만들 수 있다.

커널의 역할

1. 시스템 콜 인터페이스

* 프로세스나 스레드로부터 명령을 받는 인터페이스

* 키보드나 마우스 입력은 interrupt를 발생시켜 시스템 콜 인터페이스를 호출한다.

* 디스크 엑세스와 네트워크 요청 모두 프로세스 관점에서는 커널에 대한 시스템 콜이다.

2. 프로세스 관리

* 가동되고 있는 프로세스 관리와 CPU 이용 우선순위 등을 스케줄 한다.

3. 메모리 관리

* 서버 상의 메모리를 단위크가(ex: 4KB)의 블록으로 분할하여 프로세스에 할당한다.

4. 네트워크 스택

5. 파일 시스템 관리

* 물리 디스크에 제동괸 데이터를 관리하는 기능

* 프로세스와 스레드는 모든 것을 파일 단위로 생각한다.

* 파일 시스템 덕분에 애플리케이션은 파일이라는 단위로 데이터를 작성하거나 삭제할 수 있다.

6. 장치 드라이버

* 디스크나 NIC 등의 물리 장치용 인터페이스를 제공한다.

* 커널은 장치 드라이버를 이용해서 물리 장치를 은폐한다.

덧. 네트워크 스택과 파일 시스템 관리는 비교적 최근에 커널에 추가되었다.

모놀리식(monolithic) 커널 vs 마이크로(micro) 커널

* 모놀리식 커널은 OS의 주요 구성 요소를 모두 하나의 메모리 공간을 통해 제공한다. (Unix, Linux)

* 마이크로 커널은 최소한의 기능만 커널이 제공하고 그 외 기능은 커널 밖에서 제공한다. (Mac OS X)
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <section id="data"></section>
<script>
const Table =(_=>{
  const Private = Symbol()
  return class{
    constructor(parent){
      if(typeof parent != 'string' || !parent) throw "invalid param";
      this[Private] = {parent};
    }
    // load(url){
    //   fetch(url).then(response=>{
    //     return response.json();
    //   }).then(json=>{
    //     this._render();
    //   });
    // }
    async load(url){
      const response = await fetch(url);
      if(!response.ok) throw "invalid response";
      const json = await response.json();
      const {title, header, items} = json;
      if(!items.length) throw "no items";
      Object.assign(this[Private], {title, header, items});
      this._render();
    }
    _render(){
      // 의사코드
      // todo list가 아니라 순서대로 정리하자.
      // 부모 데이터 체크
      const fields = this[Private], parent = document.querySelector(field.parent);
      if(!parent) throw "invaild parent";
      if(!fields.items || !fields.items.length){
        parent.innerHTML = "no data";
        return;
      } else parent.innerHTML = "";
      // table 생성
      // 캡션을 title로
      const table = document.createElement("table");
      const caption = document.createElement("caption");
      caption.innerHTML = fields.title;
      table.appendChild(caption);
      // header를 thead로
      table.appendChild(
        fields.header.reduce
      )
      // items를 tr로
      // 부모에 table 삽입
      parent.appendChild(
        fields.items.reduce((table, row) => {
          table.appendChild(
            row.reduce((tr, date) => {
              const td = document.createElement("td");
              td.innerHTML = data;
              tr.appendChild(td);
              return tr;
            })
          )
        })
      )
    }

  };
})();
const table = new Table("#data")
</script>
</body>
</html>
# s70 두번째 강의

모델링

* 우리가 정말 필요한 데이터만 모은 것

함수

* 모델링 한 것을 표현할 수 있는 어휘

* 모델(DATA)을 조작하는 행위

```js
var tasks = [];
var id = 0;

var addTask = function(titile){
    tasks.push({
        title: title,
        id: id++,
        state: '진행'
    });

    render();
};

var removeTask = function(id){
    for(var i = 0; i < tasks.length; i++){
        if(tasks[i].id === id){
            tasks.splice(i, 1);
            break;
        }
    }
    
    render();
};

var changeState = function(id){
    var state;
    for(var i = 0; i < tasks.length; i++){
        if(tasks[i].id === id){
           state = tasks[i].state; 

            if(state === '진행'){
                tasks[i].state = '완료';
            } else {
                tasks[i].state = '진행';
            }
            break;
        }
    }

    render();
};

var render = function(){
    console.log('진행');
    for(var i = 0; i < tasks.length; i++){
        if(tasks[i].state === '진행'){
            console.log(tasks[i].id + ': ' + tasks[i].title);
        }
    }
    
    console.log('완료');
    for(var i = 0; i < tasks.length; i++){
        if(tasks[i].state === '완료'){
            console.log(tasks[i].id + ': ' + tasks[i].title);
        }
    }

    console.log('추가     : addTask(할일)');
    console.log('삭제     : removeTask(아이디)');
    console.log('상태변경 : changeState(아이디, 상태 - 완료 or 진행)');
};

render();
```

기획서로부터 모델을 만든다.

모델에서 behavior를 유추한다.

behavior를 함수로 만든다.

구상한 것을 코드로 만든다.

----

프로그램을 보자.

일단 id가 open되어 있다. id는 누구나 수정할 수 있다. 그러므로 에러가 발생할 확률이 매우 높다.

addTask를 즉시실행함수로 변경한다.

```js
var tasks = [];

var addTask = (function(){
    var id = 0;

    return function(title){
        tasks.push({
            id: id++,
            title: title,
            state: '진행'
        })
    };
})();
```

addTask를 즉시실행함수로 만들었다. 

그리고 addTask는 함수를 return 한다.

addTask를 즉시실행함수로 만들지 않아도 함수를 return할 수 있다.

왜 즉시실행함수로 만들었을까?

이유는 id에 있다. id가 전역스코프에서 addTask 함수의 스코프로 이동했다.

따라서 addTask함수 밖에서는 id에 직접 접근할 수 있는 방법이 없어졌다.

이것이 익명함수를 이용하여 접근권한을 제어하는 방법이다.

